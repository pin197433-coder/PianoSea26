<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title id="pageTitle">é’¢ç´æµ· - Piano Sea</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #667eea 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        .container { max-width: 100%; padding: 20px; padding-bottom: 220px; }
        header { text-align: center; padding: 30px 0 15px; }
        h1 {
            font-size: 2.2em; margin-bottom: 5px;
            background: linear-gradient(to right, #fff, #e0e0e0);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .subtitle { font-size: 1em; opacity: 0.9; }

        .ocean-selector {
            background: rgba(255,255,255,0.15); backdrop-filter: blur(10px);
            border-radius: 20px; padding: 20px; margin: 15px 0;
            border: 2px solid rgba(255,255,255,0.3);
        }
        .selector-title { font-size: 1em; margin-bottom: 15px; font-weight: 600; }
        .wave-options { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .wave-btn {
            background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3);
            color: white; padding: 15px 5px; border-radius: 15px; cursor: pointer;
            transition: all 0.3s; text-align: center;
        }
        .wave-btn.active { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: white; transform: scale(1.05);
        }
        .wave-icon { font-size: 2em; display: block; margin-bottom: 8px; }
        .wave-name { font-size: 0.9em; font-weight: 600; }
        .wave-desc { font-size: 0.7em; opacity: 0.9; margin-top: 4px; }

        .timer-selector {
            background: rgba(0,0,0,0.2); border-radius: 20px; padding: 20px; margin: 15px 0;
        }
        .timer-title { font-size: 1em; margin-bottom: 15px; }
        .timer-options { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
        .time-btn {
            background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3);
            color: white; padding: 12px 20px; border-radius: 25px; cursor: pointer;
            font-size: 0.9em; position: relative; min-width: 80px;
        }
        .time-btn.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .free-badge {
            position: absolute; top: -8px; right: -5px; background: #4ade80;
            color: #000; font-size: 0.6em; padding: 2px 6px; border-radius: 10px;
        }
        .premium-badge {
            position: absolute; top: -8px; right: -5px; background: #fbbf24;
            color: #000; font-size: 0.6em; padding: 2px 6px; border-radius: 10px;
        }
        .time-btn.locked { opacity: 0.6; }

        .lang-switcher {
            display: flex; justify-content: center; gap: 8px; margin: 15px 0; flex-wrap: wrap;
        }
        .lang-btn {
            background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3);
            color: white; padding: 8px 15px; border-radius: 20px; cursor: pointer;
            font-size: 0.85em; transition: all 0.3s;
        }
        .lang-btn.active { background: rgba(102, 126, 234, 0.6); border-color: white; }

        .scene-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 15px 0; }
        .scene-card {
            background: rgba(255,255,255,0.1); border-radius: 15px;
            padding: 20px 10px; border: 2px solid rgba(255,255,255,0.2);
            cursor: pointer; transition: all 0.3s; text-align: center;
        }
        .scene-card.active { 
            background: rgba(102, 126, 234, 0.5); border-color: white;
            transform: scale(1.02);
        }
        .scene-icon { font-size: 2.5em; margin-bottom: 8px; }
        .scene-title { font-size: 1.1em; font-weight: 600; margin-bottom: 5px; }
        .scene-duration { font-size: 0.75em; opacity: 0.8; }

        .guide-section {
            background: rgba(0,0,0,0.2); border-radius: 20px;
            padding: 20px; margin: 15px 0; text-align: center;
        }
        .status-box {
            background: rgba(255,255,255,0.1); border-radius: 12px;
            padding: 15px; margin-bottom: 15px; font-size: 0.95em;
            border-left: 4px solid #667eea; text-align: left;
        }
        .play-btn-main {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none; color: white; padding: 15px 50px;
            border-radius: 30px; cursor: pointer; font-size: 1.2em;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);
            font-weight: 600; transition: all 0.3s;
            touch-action: manipulation;
        }
        .play-btn-main:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6); }
        .play-btn-main:active { transform: translateY(0); }

        .player-controls {
            background: rgba(0,0,0,0.5); backdrop-filter: blur(20px);
            position: fixed; bottom: 0; left: 0; right: 0;
            padding: 20px; border-top: 1px solid rgba(255,255,255,0.2);
            z-index: 1000;
        }
        .timer-big { font-size: 3em; text-align: center; margin-bottom: 15px; font-weight: 300; letter-spacing: 2px; }
        .controls-row {
            display: flex; justify-content: center; align-items: center; gap: 20px;
            margin-bottom: 15px;
        }
        .btn-circle {
            width: 50px; height: 50px; border-radius: 50%;
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3);
            color: white; cursor: pointer; font-size: 1.2em; transition: all 0.3s;
            touch-action: manipulation;
        }
        .btn-circle:hover { background: rgba(255,255,255,0.2); transform: scale(1.1); }
        .btn-play-big {
            width: 70px; height: 70px; border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none; color: white; font-size: 1.8em; cursor: pointer;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);
            transition: all 0.3s;
            touch-action: manipulation;
        }
        .btn-play-big:hover { transform: scale(1.1); box-shadow: 0 8px 30px rgba(102, 126, 234, 0.6); }
        .volume-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .vol-item { text-align: center; }
        .vol-label { font-size: 0.85em; margin-bottom: 5px; }
        input[type="range"] {
            width: 100%; height: 6px; border-radius: 3px;
            background: rgba(255,255,255,0.2); -webkit-appearance: none; cursor: pointer;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%;
            background: white; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        #feedback-btn {
            position: fixed; bottom: 200px; right: 20px; width: 55px; height: 55px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: white; text-decoration: none; font-size: 24px; z-index: 9999;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); transition: all 0.3s;
            animation: pulse 2s infinite;
            touch-action: manipulation;
        }
        #feedback-btn:hover { transform: scale(1.1); }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(102, 126, 234, 0); }
            100% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0); }
        }

        .premium-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 10000; justify-content: center; align-items: center;
            padding: 20px;
        }
        .premium-content {
            background: linear-gradient(135deg, #1e3c72 0%, #667eea 100%);
            padding: 30px; border-radius: 20px; max-width: 400px; width: 100%;
            border: 2px solid rgba(255,255,255,0.2);
        }
        .premium-title { 
            font-size: 1.6em; margin-bottom: 10px; text-align: center;
            background: linear-gradient(to right, #fbbf24, #f59e0b);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .price-cards { display: flex; flex-direction: column; gap: 12px; margin: 20px 0; }
        .price-card {
            background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px; padding: 15px; cursor: pointer; position: relative;
        }
        .price-card.recommended { border-color: #fbbf24; }
        .price-card.permanent { border-color: #f59e0b; }
        .price-tag {
            position: absolute; top: -10px; right: 10px; background: #ef4444;
            color: white; font-size: 0.7em; padding: 3px 8px; border-radius: 10px;
        }
        .price-amount { font-size: 1.8em; font-weight: bold; color: #fbbf24; }
        .btn-close-modal {
            width: 100%; background: transparent; color: white;
            border: 1px solid rgba(255,255,255,0.3); padding: 12px;
            border-radius: 10px; cursor: pointer; margin-top: 15px;
        }
        .btn-close-modal:hover { background: rgba(255,255,255,0.1); }

        .now-playing {
            background: rgba(255,255,255,0.1); border-radius: 10px; padding: 10px; margin-top: 10px;
            font-size: 0.85em; text-align: center; opacity: 0.9;
        }

        .debug-info {
            background: rgba(255,255,0,0.1); border: 1px solid rgba(255,255,0,0.3);
            border-radius: 5px; padding: 5px; margin-top: 5px; font-size: 0.7em;
            color: #ffeb3b; display: none;
        }
    </style>
<base target="_blank">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¹ <span data-i18n="appName">é’¢ç´æµ·</span></h1>
            <p class="subtitle" data-i18n="subtitle">ä¸€é”®æ”¾æ¾ï¼Œä¸æµ·å…±ç”Ÿ</p>
        </header>

        <!-- æµ·åŸŸé€‰æ‹© -->
        <div class="ocean-selector">
            <div class="selector-title" data-i18n="selectOcean">ğŸŒŠ é€‰æ‹©æµ·åŸŸé£æ ¼</div>
            <div class="wave-options">
                <button class="wave-btn active" onclick="selectOcean('mediterranean')">
                    <span class="wave-icon">ğŸŒ…</span>
                    <span class="wave-name" data-i18n="ocean1">åœ°ä¸­æµ·</span>
                    <div class="wave-desc" data-i18n="ocean1Desc">è½»æŸ”ç»µé•¿</div>
                </button>
                <button class="wave-btn" onclick="selectOcean('atlantic')">
                    <span class="wave-icon">ğŸŒŠ</span>
                    <span class="wave-name" data-i18n="ocean2">å¤§è¥¿æ´‹</span>
                    <div class="wave-desc" data-i18n="ocean2Desc">è§„å¾‹èˆ’ç¼“</div>
                </button>
                <button class="wave-btn" onclick="selectOcean('pacific')">
                    <span class="wave-icon">ğŸï¸</span>
                    <span class="wave-name" data-i18n="ocean3">å¤ªå¹³æ´‹</span>
                    <div class="wave-desc" data-i18n="ocean3Desc">è‡ªç„¶æ²»æ„ˆ</div>
                </button>
            </div>
        </div>

        <!-- æ—¶æ®µé€‰æ‹© -->
        <div class="timer-selector">
            <div class="timer-title" data-i18n="selectDuration">â±ï¸ é€‰æ‹©æ”¾æ¾æ—¶é•¿</div>
            <div class="timer-options">
                <button class="time-btn active" onclick="selectTimer(15, false)">
                    <span data-i18n="min15">15åˆ†é’Ÿ</span>
                    <span class="free-badge" data-i18n="free">å…è´¹</span>
                </button>
                <button class="time-btn locked" onclick="selectTimer(30, true)">
                    <span data-i18n="min30">30åˆ†é’Ÿ</span>
                    <span class="premium-badge">VIP</span>
                </button>
                <button class="time-btn locked" onclick="selectTimer(60, true)">
                    <span data-i18n="min60">60åˆ†é’Ÿ</span>
                    <span class="premium-badge">VIP</span>
                </button>
            </div>
        </div>

        <!-- è¯­è¨€åˆ‡æ¢ -->
        <div class="lang-switcher">
            <button class="lang-btn active" onclick="changeLang('zh')">ğŸ‡¨ğŸ‡³ <span data-i18n="langZh">æ™®é€šè¯</span></button>
            <button class="lang-btn" onclick="changeLang('hk')">ğŸ‡­ğŸ‡° <span data-i18n="langHk">ç²¤è¯­</span></button>
            <button class="lang-btn" onclick="changeLang('en')">ğŸ‡¬ğŸ‡§ <span data-i18n="langEn">English</span></button>
            <button class="lang-btn" onclick="changeLang('es')">ğŸ‡ªğŸ‡¸ <span data-i18n="langEs">EspaÃ±ol</span></button>
            <button class="lang-btn" onclick="changeLang('ar')">ğŸ‡¸ğŸ‡¦ <span data-i18n="langAr">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span></button>
        </div>

        <!-- åœºæ™¯é€‰æ‹© -->
        <div class="scene-grid">
            <div class="scene-card active" onclick="selectScene('anxiety')">
                <div class="scene-icon">ğŸ§˜</div>
                <div class="scene-title" data-i18n="scene1">ç„¦è™‘æ€¥æ•‘</div>
                <div class="scene-duration" data-i18n="scene1Duration">2-3åˆ†é’Ÿè¯­éŸ³</div>
            </div>
            <div class="scene-card" onclick="selectScene('focus')">
                <div class="scene-icon">ğŸ¯</div>
                <div class="scene-title" data-i18n="scene2">é™å¿ƒä¸“æ³¨</div>
                <div class="scene-duration" data-i18n="scene2Duration">1åˆ†é’Ÿè¯­éŸ³</div>
            </div>
            <div class="scene-card" onclick="selectScene('sleep')">
                <div class="scene-icon">ğŸŒ™</div>
                <div class="scene-title" data-i18n="scene3">ç¡å‰åŠ©çœ </div>
                <div class="scene-duration" data-i18n="scene3Duration">3-5åˆ†é’Ÿè¯­éŸ³</div>
            </div>
            <div class="scene-card" onclick="selectScene('nap')">
                <div class="scene-icon">ğŸ˜´</div>
                <div class="scene-title" data-i18n="scene4">åˆä¼‘å°æ†©</div>
                <div class="scene-duration" data-i18n="scene4Duration">3åˆ†é’Ÿè¯­éŸ³</div>
            </div>
        </div>

        <!-- æ’­æ”¾æ§åˆ¶ -->
        <div class="guide-section">
            <div class="status-box" id="statusBox">
                <div data-i18n="currentStatus">å½“å‰é…ç½®å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
            </div>
            <div class="now-playing" id="nowPlaying" style="display:none;">
                ğŸµ <span id="trackInfo">æ­£åœ¨åŠ è½½...</span>
            </div>
            <div class="debug-info" id="debugInfo"></div>
            <button class="play-btn-main" id="mainPlayBtn" onclick="toggleMainPlay()">
                <span data-i18n="startBtn">â–¶ï¸ å¼€å§‹æ”¾æ¾</span>
            </button>
        </div>
    </div>

    <!-- åº•éƒ¨æ’­æ”¾å™¨ -->
    <div class="player-controls">
        <div class="timer-big" id="timerDisplay">15:00</div>
        <div class="controls-row">
            <button class="btn-circle" onclick="stopAll()" title="Stop">â¹</button>
            <button class="btn-play-big" id="playPauseBtn" onclick="togglePlay()">â–¶</button>
            <button class="btn-circle" onclick="toggleMute()" title="Mute" id="muteBtn">ğŸ”Š</button>
        </div>
        <div class="volume-grid">
            <div class="vol-item">
                <div class="vol-label" data-i18n="volPiano">ğŸ¹ é’¢ç´</div>
                <input type="range" id="volPiano" min="0" max="100" value="60" oninput="updateVolume('piano', this.value)">
            </div>
            <div class="vol-item">
                <div class="vol-label" data-i18n="volWave">ğŸŒŠ æµ·æµª</div>
                <input type="range" id="volWave" min="0" max="100" value="50" oninput="updateVolume('wave', this.value)">
            </div>
            <div class="vol-item">
                <div class="vol-label" data-i18n="volVoice">ğŸ™ï¸ è¯­éŸ³</div>
                <input type="range" id="volVoice" min="0" max="100" value="80" oninput="updateVolume('voice', this.value)">
            </div>
        </div>
    </div>

    <a href="https://forms.gle/r6znYF8Pr5ffVmAv9" target="_blank" id="feedback-btn" title="æ„è§åé¦ˆ">ğŸ’¬</a>

    <!-- VIPå¼¹çª— -->
    <div class="premium-modal" id="premiumModal">
        <div class="premium-content">
            <div class="premium-title" data-i18n="upgradeVIP">ğŸ”“ å‡çº§VIPä¼šå‘˜</div>
            <div style="text-align: center; margin-bottom: 20px; opacity: 0.9;" data-i18n="vipSubtitle">è§£é”å®Œæ•´æ”¾æ¾ä½“éªŒ</div>

            <div class="price-cards">
                <div class="price-card" onclick="selectPlan('month')">
                    <div style="font-size: 0.8em; opacity: 0.8;" data-i18n="monthly">æœˆåº¦ä¼šå‘˜</div>
                    <div><span class="price-amount" id="priceMonth">Â¥18</span><span style="font-size: 0.9em;">/<span data-i18n="perMonth">æœˆ</span></span></div>
                    <div style="font-size: 0.75em; margin-top: 5px;" id="descMonth" data-i18n="monthlyDesc">é€‚åˆçŸ­æœŸä½“éªŒ</div>
                </div>

                <div class="price-card recommended" onclick="selectPlan('year')">
                    <span class="price-tag" data-i18n="recommended">æ¨è</span>
                    <div style="font-size: 0.8em; opacity: 0.8;" data-i18n="yearly">å¹´åº¦ä¼šå‘˜</div>
                    <div><span class="price-amount" id="priceYear">Â¥238</span><span style="font-size: 0.9em;">/<span data-i18n="perYear">å¹´</span></span></div>
                    <div style="font-size: 0.75em; margin-top: 5px;" id="descYear" data-i18n="yearlyDesc">ç«‹çœ178å…ƒ</div>
                </div>

                <div class="price-card permanent" onclick="selectPlan('permanent')">
                    <span class="price-tag" data-i18n="bestValue">è¶…å€¼</span>
                    <div style="font-size: 0.8em; opacity: 0.8;" data-i18n="permanent">æ°¸ä¹…ä¼šå‘˜</div>
                    <div><span class="price-amount" id="pricePermanent">Â¥498</span></div>
                    <div style="font-size: 0.75em; margin-top: 5px;" data-i18n="permanentDesc">ä¸€æ¬¡ä»˜è´¹ç»ˆèº«äº«ç”¨</div>
                </div>
            </div>

            <ul style="font-size: 0.85em; margin: 15px 0; padding-left: 20px;">
                <li data-i18n="vipFeature1">âœ“ 30/60åˆ†é’Ÿæ·±åº¦æ”¾æ¾</li>
                <li data-i18n="vipFeature2">âœ“ å…¨éƒ¨5ç§è¯­è¨€å®Œæ•´ç‰ˆ</li>
                <li data-i18n="vipFeature3">âœ“ 3ç§çœŸå®æµ·åŸŸæµ·æµªå£°</li>
                <li data-i18n="vipFeature4">âœ“ ç¦»çº¿ä¸‹è½½åŠŸèƒ½</li>
                <li data-i18n="vipFeature5">âœ“ æ— å¹¿å‘Šçº¯å‡€ä½“éªŒ</li>
            </ul>

            <button class="btn-close-modal" onclick="closePremium()" data-i18n="continueFree">ğŸ‘‹ ç»§ç»­å…è´¹ä½“éªŒ</button>
        </div>
    </div>

    <script>
        // å¤šè¯­è¨€é…ç½® - åŒ…å«ä»·æ ¼è®¾ç½®
        const translations = {
            zh: {
                appName: "é’¢ç´æµ·", subtitle: "ä¸€é”®æ”¾æ¾ï¼Œä¸æµ·å…±ç”Ÿ",
                selectOcean: "ğŸŒŠ é€‰æ‹©æµ·åŸŸé£æ ¼", 
                ocean1: "åœ°ä¸­æµ·", ocean1Desc: "è½»æŸ”ç»µé•¿",
                ocean2: "å¤§è¥¿æ´‹", ocean2Desc: "è§„å¾‹èˆ’ç¼“", 
                ocean3: "å¤ªå¹³æ´‹", ocean3Desc: "è‡ªç„¶æ²»æ„ˆ",
                selectDuration: "â±ï¸ é€‰æ‹©æ”¾æ¾æ—¶é•¿",
                min15: "15åˆ†é’Ÿ", min30: "30åˆ†é’Ÿ", min60: "60åˆ†é’Ÿ",
                free: "å…è´¹", langZh: "æ™®é€šè¯", langHk: "ç²¤è¯­",
                langEn: "English", langEs: "EspaÃ±ol", langAr: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
                scene1: "ç„¦è™‘æ€¥æ•‘", scene1Duration: "2-3åˆ†é’Ÿè¯­éŸ³",
                scene2: "é™å¿ƒä¸“æ³¨", scene2Duration: "1åˆ†é’Ÿè¯­éŸ³",
                scene3: "ç¡å‰åŠ©çœ ", scene3Duration: "3-5åˆ†é’Ÿè¯­éŸ³", 
                scene4: "åˆä¼‘å°æ†©", scene4Duration: "3åˆ†é’Ÿè¯­éŸ³",
                currentStatus: "å½“å‰ï¼šåœ°ä¸­æµ· + ç„¦è™‘æ€¥æ•‘ + æ™®é€šè¯ + 15åˆ†é’Ÿï¼ˆå…è´¹ï¼‰",
                startBtn: "â–¶ï¸ å¼€å§‹æ”¾æ¾", pauseBtn: "â¸ï¸ æš‚åœ", continueBtn: "â–¶ï¸ ç»§ç»­",
                volPiano: "ğŸ¹ é’¢ç´", volWave: "ğŸŒŠ æµ·æµª", volVoice: "ğŸ™ï¸ è¯­éŸ³",
                upgradeVIP: "ğŸ”“ å‡çº§VIPä¼šå‘˜", vipSubtitle: "è§£é”å®Œæ•´æ”¾æ¾ä½“éªŒ",
                monthly: "æœˆåº¦ä¼šå‘˜", perMonth: "æœˆ", monthlyDesc: "é€‚åˆçŸ­æœŸä½“éªŒ",
                yearly: "å¹´åº¦ä¼šå‘˜", perYear: "å¹´", yearlyDesc: "ç«‹çœ178å…ƒ",
                permanent: "æ°¸ä¹…ä¼šå‘˜", permanentDesc: "ä¸€æ¬¡ä»˜è´¹ç»ˆèº«äº«ç”¨",
                recommended: "æ¨è", bestValue: "è¶…å€¼",
                vipFeature1: "âœ“ 30/60åˆ†é’Ÿæ·±åº¦æ”¾æ¾",
                vipFeature2: "âœ“ å…¨éƒ¨5ç§è¯­è¨€å®Œæ•´ç‰ˆ",
                vipFeature3: "âœ“ 3ç§çœŸå®æµ·åŸŸæµ·æµªå£°",
                vipFeature4: "âœ“ ç¦»çº¿ä¸‹è½½åŠŸèƒ½",
                vipFeature5: "âœ“ æ— å¹¿å‘Šçº¯å‡€ä½“éªŒ",
                continueFree: "ğŸ‘‹ ç»§ç»­å…è´¹ä½“éªŒ",
                feedback: "æ„è§åé¦ˆ",
                loading: "åŠ è½½ä¸­...",
                errorLoad: "åŠ è½½å¤±è´¥",
                // äººæ°‘å¸ä»·æ ¼
                priceMonth: "Â¥18",
                priceYear: "Â¥238", 
                pricePermanent: "Â¥498",
                saveAmount: "ç«‹çœ178å…ƒ"
            },
            hk: {
                appName: "é‹¼ç´æµ·", subtitle: "ä¸€éµæ”¾é¬†ï¼Œèˆ‡æµ·å…±ç”Ÿ",
                selectOcean: "ğŸŒŠ é¸æ“‡æµ·åŸŸé¢¨æ ¼",
                ocean1: "åœ°ä¸­æµ·", ocean1Desc: "è¼•æŸ”ç¶¿é•·",
                ocean2: "å¤§è¥¿æ´‹", ocean2Desc: "è¦å¾‹èˆ’ç·©",
                ocean3: "å¤ªå¹³æ´‹", ocean3Desc: "è‡ªç„¶æ²»æ„ˆ",
                selectDuration: "â±ï¸ é¸æ“‡æ”¾é¬†æ™‚é•·",
                min15: "15åˆ†é˜", min30: "30åˆ†é˜", min60: "60åˆ†é˜",
                free: "å…è²»", langZh: "æ™®é€šè©±", langHk: "ç²µèª",
                langEn: "English", langEs: "EspaÃ±ol", langAr: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
                scene1: "ç„¦æ…®æ€¥æ•‘", scene1Duration: "2-3åˆ†é˜èªéŸ³",
                scene2: "éœå¿ƒå°ˆæ³¨", scene2Duration: "1åˆ†é˜èªéŸ³",
                scene3: "ç¡å‰åŠ©çœ ", scene3Duration: "3-5åˆ†é˜èªéŸ³",
                scene4: "åˆä¼‘å°æ†©", scene4Duration: "3åˆ†é˜èªéŸ³",
                currentStatus: "ç•¶å‰ï¼šåœ°ä¸­æµ· + ç„¦æ…®æ€¥æ•‘ + ç²µèª + 15åˆ†é˜ï¼ˆå…è²»ï¼‰",
                startBtn: "â–¶ï¸ é–‹å§‹æ”¾é¬†", pauseBtn: "â¸ï¸ æš«åœ", continueBtn: "â–¶ï¸ ç¹¼çºŒ",
                volPiano: "ğŸ¹ é‹¼ç´", volWave: "ğŸŒŠ æµ·æµª", volVoice: "ğŸ™ï¸ èªéŸ³",
                upgradeVIP: "ğŸ”“ å‡ç´šVIPæœƒå“¡", vipSubtitle: "è§£é–å®Œæ•´æ”¾é¬†é«”é©—",
                monthly: "æœˆåº¦æœƒå“¡", perMonth: "æœˆ", monthlyDesc: "é©åˆçŸ­æœŸé«”é©—",
                yearly: "å¹´åº¦æœƒå“¡", perYear: "å¹´", yearlyDesc: "ç«‹çœ178å…ƒ",
                permanent: "æ°¸ä¹…æœƒå“¡", permanentDesc: "ä¸€æ¬¡ä»˜è²»çµ‚èº«äº«ç”¨",
                recommended: "æ¨è–¦", bestValue: "è¶…å€¼",
                vipFeature1: "âœ“ 30/60åˆ†é˜æ·±åº¦æ”¾é¬†",
                vipFeature2: "âœ“ å…¨éƒ¨5ç¨®èªè¨€å®Œæ•´ç‰ˆ",
                vipFeature3: "âœ“ 3ç¨®çœŸå¯¦æµ·åŸŸæµ·æµªè²",
                vipFeature4: "âœ“ é›¢ç·šä¸‹è¼‰åŠŸèƒ½",
                vipFeature5: "âœ“ ç„¡å»£å‘Šç´”æ·¨é«”é©—",
                continueFree: "ğŸ‘‹ ç¹¼çºŒå…è²»é«”é©—",
                feedback: "æ„è¦‹åé¥‹",
                loading: "åŠ è¼‰ä¸­...",
                errorLoad: "åŠ è¼‰å¤±æ•—",
                // äººæ°‘å¸ä»·æ ¼
                priceMonth: "Â¥18",
                priceYear: "Â¥238",
                pricePermanent: "Â¥498",
                saveAmount: "ç«‹çœ178å…ƒ"
            },
            en: {
                appName: "Piano Sea", subtitle: "Relax with one click",
                selectOcean: "ğŸŒŠ Select Ocean Style",
                ocean1: "Mediterranean", ocean1Desc: "Gentle & Soft",
                ocean2: "Atlantic", ocean2Desc: "Calm & Regular",
                ocean3: "Pacific", ocean3Desc: "Natural Healing",
                selectDuration: "â±ï¸ Select Duration",
                min15: "15 min", min30: "30 min", min60: "60 min",
                free: "FREE", langZh: "ä¸­æ–‡", langHk: "Cantonese",
                langEn: "English", langEs: "EspaÃ±ol", langAr: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
                scene1: "Anxiety Relief", scene1Duration: "2-3 min voice",
                scene2: "Focus", scene2Duration: "1 min voice",
                scene3: "Deep Sleep", scene3Duration: "3-5 min voice",
                scene4: "Power Nap", scene4Duration: "3 min voice",
                currentStatus: "Current: Mediterranean + Anxiety Relief + English + 15min (Free)",
                startBtn: "â–¶ï¸ Start Relaxing", pauseBtn: "â¸ï¸ Pause", continueBtn: "â–¶ï¸ Continue",
                volPiano: "ğŸ¹ Piano", volWave: "ğŸŒŠ Waves", volVoice: "ğŸ™ï¸ Voice",
                upgradeVIP: "ğŸ”“ Upgrade to VIP", vipSubtitle: "Unlock full relaxation experience",
                monthly: "Monthly", perMonth: "mo", monthlyDesc: "Good for short-term",
                yearly: "Yearly", perYear: "yr", yearlyDesc: "Save $12",
                permanent: "Lifetime", permanentDesc: "Pay once, enjoy forever",
                recommended: "REC", bestValue: "BEST",
                vipFeature1: "âœ“ 30/60 min deep relaxation",
                vipFeature2: "âœ“ All 5 languages complete",
                vipFeature3: "âœ“ 3 real ocean wave sounds",
                vipFeature4: "âœ“ Offline download",
                vipFeature5: "âœ“ Ad-free experience",
                continueFree: "ğŸ‘‹ Continue Free Experience",
                feedback: "Feedback",
                loading: "Loading...",
                errorLoad: "Load Failed",
                // ç¾å…ƒä»·æ ¼
                priceMonth: "$5",
                priceYear: "$48",
                pricePermanent: "$150",
                saveAmount: "Save $12"
            },
            es: {
                appName: "Piano Mar", subtitle: "RelÃ¡jate con un clic",
                selectOcean: "ğŸŒŠ Estilo de OcÃ©ano",
                ocean1: "MediterrÃ¡neo", ocean1Desc: "Suave y Largo",
                ocean2: "AtlÃ¡ntico", ocean2Desc: "Tranquilo y Regular",
                ocean3: "PacÃ­fico", ocean3Desc: "SanaciÃ³n Natural",
                selectDuration: "â±ï¸ DuraciÃ³n",
                min15: "15 min", min30: "30 min", min60: "60 min",
                free: "GRATIS", langZh: "ä¸­æ–‡", langHk: "CantonÃ©s",
                langEn: "English", langEs: "EspaÃ±ol", langAr: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
                scene1: "Alivio Ansiedad", scene1Duration: "2-3 min voz",
                scene2: "Enfoque", scene2Duration: "1 min voz",
                scene3: "SueÃ±o Profundo", scene3Duration: "3-5 min voz",
                scene4: "Siesta", scene4Duration: "3 min voz",
                currentStatus: "Actual: MediterrÃ¡neo + Alivio + EspaÃ±ol + 15min (Gratis)",
                startBtn: "â–¶ï¸ Empezar", pauseBtn: "â¸ï¸ Pausa", continueBtn: "â–¶ï¸ Continuar",
                volPiano: "ğŸ¹ Piano", volWave: "ğŸŒŠ Olas", volVoice: "ğŸ™ï¸ Voz",
                upgradeVIP: "ğŸ”“ Actualizar a VIP", vipSubtitle: "Desbloquea experiencia completa",
                monthly: "Mensual", perMonth: "mes", monthlyDesc: "Corto plazo",
                yearly: "Anual", perYear: "aÃ±o", yearlyDesc: "Ahorra $12",
                permanent: "Permanente", permanentDesc: "Paga una vez, disfruta siempre",
                recommended: "TOP", bestValue: "MEJOR",
                vipFeature1: "âœ“ RelajaciÃ³n 30/60 min",
                vipFeature2: "âœ“ 5 idiomas completos",
                vipFeature3: "âœ“ 3 sonidos de olas reales",
                vipFeature4: "âœ“ Descarga offline",
                vipFeature5: "âœ“ Sin anuncios",
                continueFree: "ğŸ‘‹ Continuar Gratis",
                feedback: "Comentarios",
                loading: "Cargando...",
                errorLoad: "Error al cargar",
                // ç¾å…ƒä»·æ ¼
                priceMonth: "$5",
                priceYear: "$48",
                pricePermanent: "$150",
                saveAmount: "Ahorra $12"
            },
            ar: {
                appName: "Ø¨ÙŠØ§Ù†Ùˆ Ø³ÙŠ", subtitle: "Ø§Ø³ØªØ±Ø®Ø§Ø¡ Ø¨Ù†Ù‚Ø±Ø© ÙˆØ§Ø­Ø¯Ø©",
                selectOcean: "ğŸŒŠ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙŠØ·",
                ocean1: "Ø§Ù„Ù…ØªÙˆØ³Ø·", ocean1Desc: "Ù†Ø§Ø¹Ù… ÙˆØ·ÙˆÙŠÙ„",
                ocean2: "Ø§Ù„Ø£Ø·Ù„Ø³ÙŠ", ocean2Desc: "Ù‡Ø§Ø¯Ø¦ ÙˆÙ…Ù†ØªØ¸Ù…",
                ocean3: "Ø§Ù„Ù‡Ø§Ø¯Ø¦", ocean3Desc: "Ø´ÙØ§Ø¡ Ø·Ø¨ÙŠØ¹ÙŠ",
                selectDuration: "â±ï¸ Ø§Ù„Ù…Ø¯Ø©",
                min15: "15 Ø¯", min30: "30 Ø¯", min60: "60 Ø¯",
                free: "Ù…Ø¬Ø§Ù†ÙŠ", langZh: "ä¸­æ–‡", langHk: "Ø§Ù„ÙƒØ§Ù†ØªÙˆÙ†ÙŠØ©",
                langEn: "English", langEs: "EspaÃ±ol", langAr: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
                scene1: "ØªØ®ÙÙŠÙ Ø§Ù„Ù‚Ù„Ù‚", scene1Duration: "2-3 Ø¯ ØµÙˆØª",
                scene2: "ØªØ±ÙƒÙŠØ²", scene2Duration: "1 Ø¯ ØµÙˆØª",
                scene3: "Ù†ÙˆÙ… Ø¹Ù…ÙŠÙ‚", scene3Duration: "3-5 Ø¯ ØµÙˆØª",
                scene4: "Ù‚ÙŠÙ„ÙˆÙ„Ø©", scene4Duration: "3 Ø¯ ØµÙˆØª",
                currentStatus: "Ø§Ù„Ø­Ø§Ù„ÙŠ: Ø§Ù„Ù…ØªÙˆØ³Ø· + ØªØ®ÙÙŠÙ Ø§Ù„Ù‚Ù„Ù‚ + Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© + 15Ø¯ (Ù…Ø¬Ø§Ù†ÙŠ)",
                startBtn: "â–¶ï¸ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø³ØªØ±Ø®Ø§Ø¡", pauseBtn: "â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª", continueBtn: "â–¶ï¸ Ø§Ø³ØªÙ…Ø±Ø§Ø±",
                volPiano: "ğŸ¹ Ø¨ÙŠØ§Ù†Ùˆ", volWave: "ğŸŒŠ Ø£Ù…ÙˆØ§Ø¬", volVoice: "ğŸ™ï¸ ØµÙˆØª",
                upgradeVIP: "ğŸ”“ ØªØ±Ù‚ÙŠØ© Ø¥Ù„Ù‰ VIP", vipSubtitle: "Ø§ÙØªØ­ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ±Ø®Ø§Ø¡ Ø§Ù„ÙƒØ§Ù…Ù„Ø©",
                monthly: "Ø´Ù‡Ø±ÙŠ", perMonth: "Ø´Ù‡Ø±", monthlyDesc: "Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰",
                yearly: "Ø³Ù†ÙˆÙŠ", perYear: "Ø³Ù†Ø©", yearlyDesc: "ÙˆÙØ± $12",
                permanent: "Ø¯Ø§Ø¦Ù…", permanentDesc: "Ø§Ø¯ÙØ¹ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©ØŒ Ø§Ø³ØªÙ…ØªØ¹ Ù„Ù„Ø£Ø¨Ø¯",
                recommended: "Ù…ÙˆØµÙ‰ Ø¨Ù‡", bestValue: "Ø§Ù„Ø£ÙØ¶Ù„",
                vipFeature1: "âœ“ Ø§Ø³ØªØ±Ø®Ø§Ø¡ 30/60 Ø¯",
                vipFeature2: "âœ“ 5 Ù„ØºØ§Øª ÙƒØ§Ù…Ù„Ø©",
                vipFeature3: "âœ“ 3 Ø£ØµÙˆØ§Øª Ø£Ù…ÙˆØ§Ø¬ Ø­Ù‚ÙŠÙ‚ÙŠØ©",
                vipFeature4: "âœ“ ØªØ­Ù…ÙŠÙ„ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª",
                vipFeature5: "âœ“ Ø¨Ø¯ÙˆÙ† Ø¥Ø¹Ù„Ø§Ù†Ø§Øª",
                continueFree: "ğŸ‘‹ Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¬Ø§Ù†Ø§Ù‹",
                feedback: "ØªØ¹Ù„ÙŠÙ‚Ø§Øª",
                loading: "Ø¬Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„...",
                errorLoad: "ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„",
                // ç¾å…ƒä»·æ ¼
                priceMonth: "$5",
                priceYear: "$48",
                pricePermanent: "$150",
                saveAmount: "ÙˆÙØ± $12"
            }
        };

        // éŸ³é¢‘æ–‡ä»¶æ˜ å°„é…ç½®
        const audioConfig = {
            oceans: {
                mediterranean: encodeURIComponent('audio/wave1.mp3'),
                atlantic: encodeURIComponent('audio/wave2.mp3'),
                pacific: encodeURIComponent('audio/wave3.mp3')
            },
            voices: {
                anxiety: {
                    zh: encodeURIComponent('audio/ç„¦è™‘æ€¥æ•‘-æ™®é€šè¯.mp3'),
                    hk: encodeURIComponent('audio/ç„¦è™‘æ€¥æ•‘-ç²¤è¯­.mp3'),
                    en: encodeURIComponent('audio/ç„¦è™‘æ€¥æ•‘-è‹±è¯­.mp3'),
                    es: encodeURIComponent('audio/ç„¦è™‘æ€¥æ•‘-è¥¿ç­ç‰™è¯­.mp3'),
                    ar: encodeURIComponent('audio/ç„¦è™‘æ€¥æ•‘-é˜¿æ‹‰ä¼¯è¯­.mp3')
                },
                focus: {
                    zh: encodeURIComponent('audio/é™å¿ƒä¸“æ³¨-æ™®é€šè¯.mp3'),
                    hk: encodeURIComponent('audio/é™å¿ƒä¸“æ³¨-ç²¤è¯­.mp3'),
                    en: encodeURIComponent('audio/é™å¿ƒä¸“æ³¨-è‹±è¯­.mp3'),
                    es: encodeURIComponent('audio/é™å¿ƒä¸“æ³¨-è¥¿ç­ç‰™è¯­.mp3'),
                    ar: encodeURIComponent('audio/é™å¿ƒä¸“æ³¨-é˜¿æ‹‰ä¼¯è¯­.mp3')
                },
                sleep: {
                    zh: encodeURIComponent('audio/ç¡å‰åŠ©çœ -æ™®é€šè¯.mp3'),
                    hk: encodeURIComponent('audio/ç¡å‰åŠ©çœ -ç²¤è¯­.mp3'),
                    en: encodeURIComponent('audio/ç¡å‰åŠ©çœ -è‹±è¯­.mp3'),
                    es: encodeURIComponent('audio/ç¡å‰åŠ©çœ -è¥¿ç­ç‰™è¯­.mp3'),
                    ar: encodeURIComponent('audio/ç¡å‰åŠ©çœ -é˜¿æ‹‰ä¼¯è¯­.mp3')
                },
                nap: {
                    zh: encodeURIComponent('audio/åˆä¼‘å°æ†©-æ™®é€šè¯.mp3'),
                    hk: encodeURIComponent('audio/åˆä¼‘å°æ†©-ç²¤è¯­.mp3'),
                    en: encodeURIComponent('audio/åˆä¼‘å°æ†©-è‹±è¯­.mp3'),
                    es: encodeURIComponent('audio/åˆä¼‘å°æ†©-è¥¿ç­ç‰™è¯­.mp3'),
                    ar: encodeURIComponent('audio/åˆä¼‘å°æ†©-é˜¿æ‹‰ä¼¯è¯­.mp3')
                }
            },
            piano: {
                anxiety: [
                    encodeURIComponent('audio/piano_anxiety BackgroundDocumentary.mp3'),
                    encodeURIComponent('audio/piano_anxiety CalmWaves.mp3'),
                    encodeURIComponent('audio/piano_anxiety emotional.mp3')
                ],
                focus: [
                    encodeURIComponent('audio/piano_focus minimalisticPrelude.mp3'),
                    encodeURIComponent('audio/piano_focus scarboroughFair.mp3'),
                    encodeURIComponent('audio/piano_focus variatio14a2clav.mp3')
                ],
                sleep: [
                    encodeURIComponent('audio/piano_sleep daylight.mp3'),
                    encodeURIComponent('audio/piano_sleep SoftPiano.mp3'),
                    encodeURIComponent('audio/piano_sleep SoftPiano2.mp3')
                ],
                nap: [
                    encodeURIComponent('audio/piano_nap cafeJazz.mp3'),
                    encodeURIComponent('audio/piano_nap Inspiring.mp3'),
                    encodeURIComponent('audio/piano_nap morningZen.mp3')
                ]
            }
        };

        const scenes = {
            anxiety: { key: 'scene1', duration: 'scene1Duration', name: 'ç„¦è™‘æ€¥æ•‘' },
            focus: { key: 'scene2', duration: 'scene2Duration', name: 'é™å¿ƒä¸“æ³¨' },
            sleep: { key: 'scene3', duration: 'scene3Duration', name: 'ç¡å‰åŠ©çœ ' },
            nap: { key: 'scene4', duration: 'scene4Duration', name: 'åˆä¼‘å°æ†©' }
        };

        const oceanNames = {
            mediterranean: 'ocean1',
            atlantic: 'ocean2',
            pacific: 'ocean3'
        };

        let current = { 
            lang: 'zh', 
            scene: 'anxiety', 
            ocean: 'mediterranean', 
            timer: 15,
            isPlaying: false,
            isPaused: false,
            timeLeft: 15 * 60,
            timerInterval: null,
            currentPianoIndex: 0,
            audioLoaded: { piano: false, wave: false, voice: false }
        };

        let audioPlayers = {
            piano: null,
            wave: null,
            voice: null
        };

        function showDebug(msg) {
            const debugEl = document.getElementById('debugInfo');
            if (debugEl) {
                debugEl.style.display = 'block';
                debugEl.textContent = msg;
            }
            console.log('[PianoSea]', msg);
        }

        function initAudio() {
            try {
                if (audioPlayers.piano) {
                    audioPlayers.piano.pause();
                    audioPlayers.piano.src = '';
                }
                if (audioPlayers.wave) {
                    audioPlayers.wave.pause();
                    audioPlayers.wave.src = '';
                }
                if (audioPlayers.voice) {
                    audioPlayers.voice.pause();
                    audioPlayers.voice.src = '';
                }

                audioPlayers.piano = new Audio();
                audioPlayers.wave = new Audio();
                audioPlayers.voice = new Audio();

                audioPlayers.piano.loop = true;
                audioPlayers.wave.loop = true;
                audioPlayers.voice.loop = false;
                audioPlayers.piano.volume = 0.6;
                audioPlayers.wave.volume = 0.5;
                audioPlayers.voice.volume = 0.8;

                audioPlayers.piano.playsinline = true;
                audioPlayers.wave.playsinline = true;
                audioPlayers.voice.playsinline = true;
                audioPlayers.piano.setAttribute('playsinline', '');
                audioPlayers.wave.setAttribute('playsinline', '');
                audioPlayers.voice.setAttribute('playsinline', '');

                setupAudioListeners();

                current.audioLoaded = { piano: false, wave: false, voice: false };
                showDebug('éŸ³é¢‘åˆå§‹åŒ–å®Œæˆ');
                return true;
            } catch (e) {
                showDebug('éŸ³é¢‘åˆå§‹åŒ–å¤±è´¥: ' + e.message);
                return false;
            }
        }

        function setupAudioListeners() {
            audioPlayers.piano.oncanplaythrough = function() {
                current.audioLoaded.piano = true;
                showDebug('âœ“ é’¢ç´æ›²åŠ è½½å®Œæˆ');
            };
            audioPlayers.piano.onerror = function(e) {
                showDebug('âœ— é’¢ç´æ›²åŠ è½½å¤±è´¥: ' + audioPlayers.piano.src);
                console.error('é’¢ç´é”™è¯¯:', e);
            };

            audioPlayers.wave.oncanplaythrough = function() {
                current.audioLoaded.wave = true;
                showDebug('âœ“ æµ·æµªå£°åŠ è½½å®Œæˆ');
            };
            audioPlayers.wave.onerror = function(e) {
                showDebug('âœ— æµ·æµªå£°åŠ è½½å¤±è´¥: ' + audioPlayers.wave.src);
            };

            audioPlayers.voice.oncanplaythrough = function() {
                current.audioLoaded.voice = true;
                showDebug('âœ“ è¯­éŸ³åŠ è½½å®Œæˆ');
            };
            audioPlayers.voice.onerror = function(e) {
                showDebug('âœ— è¯­éŸ³åŠ è½½å¤±è´¥: ' + audioPlayers.voice.src);
            };

            audioPlayers.voice.onended = function() {
                showDebug('è¯­éŸ³æ’­æ”¾å®Œæˆ');
            };
        }

        function changeLang(lang) {
            current.lang = lang;

            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.lang-btn').classList.add('active');

            const t = translations[lang];

            // æ›´æ–°æ‰€æœ‰å¸¦ data-i18n çš„å…ƒç´ 
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) el.textContent = t[key];
            });

            // æ›´æ–°ä»·æ ¼æ˜¾ç¤º
            updatePrices(lang);

            updateSceneText();
            updateStatus();
            document.getElementById('pageTitle').textContent = t.appName + ' - ' + t.subtitle;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';

            if (current.isPlaying) {
                loadAndPlayAudio();
            }
        }

        // æ›´æ–°ä»·æ ¼æ˜¾ç¤ºå‡½æ•°
        function updatePrices(lang) {
            const t = translations[lang];

            // æ›´æ–°æœˆåº¦ä»·æ ¼
            document.getElementById('priceMonth').textContent = t.priceMonth;

            // æ›´æ–°å¹´åº¦ä»·æ ¼
            document.getElementById('priceYear').textContent = t.priceYear;

            // æ›´æ–°æ°¸ä¹…ä»·æ ¼
            document.getElementById('pricePermanent').textContent = t.pricePermanent;

            // æ›´æ–°å¹´åº¦èŠ‚çœæè¿°
            document.getElementById('descYear').textContent = t.saveAmount;
        }

        function updateSceneText() {
            const t = translations[current.lang];
            const sceneKeys = ['anxiety', 'focus', 'sleep', 'nap'];
            document.querySelectorAll('.scene-card').forEach((card, index) => {
                const key = sceneKeys[index];
                card.querySelector('.scene-title').textContent = t[scenes[key].key];
                card.querySelector('.scene-duration').textContent = t[scenes[key].duration];
            });
        }

        function selectOcean(ocean) {
            current.ocean = ocean;
            document.querySelectorAll('.wave-btn').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');
            updateStatus();

            if (current.isPlaying && audioPlayers.wave) {
                const waveFile = audioConfig.oceans[ocean];
                audioPlayers.wave.src = decodeURIComponent(waveFile);
                audioPlayers.wave.load();
                audioPlayers.wave.play().catch(e => {
                    showDebug('æµ·æµªåˆ‡æ¢å¤±è´¥: ' + e.message);
                });
            }
        }

        function selectScene(scene) {
            current.scene = scene;
            document.querySelectorAll('.scene-card').forEach(card => card.classList.remove('active'));
            event.currentTarget.classList.add('active');
            updateStatus();

            current.currentPianoIndex = Math.floor(Math.random() * 3);

            if (current.isPlaying) {
                loadAndPlayAudio();
            }
        }

        function selectTimer(minutes, isPremium) {
            if (isPremium) {
                document.getElementById('premiumModal').style.display = 'flex';
                return;
            }
            current.timer = minutes;
            current.timeLeft = minutes * 60;
            updateTimerDisplay();

            document.querySelectorAll('.time-btn').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');
            updateStatus();
        }

        function updateStatus() {
            const t = translations[current.lang];
            const oceanName = t[oceanNames[current.ocean]];
            const sceneName = t[scenes[current.scene].key];
            const timerType = current.timer === 15 ? t.free : 'VIP';

            document.getElementById('statusBox').innerHTML = `
                <div>${t.selectOcean.replace('ğŸŒŠ ', '')}: ${oceanName} | ${sceneName} | ${current.timer}min (${timerType})</div>
            `;
        }

        function toggleMainPlay() {
            if (current.isPlaying) {
                pauseAll();
            } else {
                startPlaying();
            }
        }

        async function startPlaying() {
            showDebug('å¼€å§‹åˆå§‹åŒ–...');

            if (!initAudio()) {
                alert('éŸ³é¢‘åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®');
                return;
            }

            current.isPlaying = true;
            current.isPaused = false;

            showDebug('åŠ è½½éŸ³é¢‘æ–‡ä»¶...');
            await loadAndPlayAudio();

            startTimer();
            updatePlayButtonUI();
            document.getElementById('nowPlaying').style.display = 'block';
            updateTrackInfo();
        }

        async function loadAndPlayAudio() {
            const t = translations[current.lang];

            try {
                const pianoFile = decodeURIComponent(audioConfig.piano[current.scene][current.currentPianoIndex]);
                const waveFile = decodeURIComponent(audioConfig.oceans[current.ocean]);
                const voiceFile = decodeURIComponent(audioConfig.voices[current.scene][current.lang]);

                showDebug(`åŠ è½½: ${current.scene}åœºæ™¯`);

                audioPlayers.piano.src = pianoFile;
                audioPlayers.wave.src = waveFile;
                audioPlayers.voice.src = voiceFile;

                audioPlayers.piano.load();
                audioPlayers.wave.load();
                audioPlayers.voice.load();

                setTimeout(async () => {
                    try {
                        showDebug('å°è¯•æ’­æ”¾...');

                        const playPromises = [
                            audioPlayers.piano.play().catch(e => {
                                showDebug('é’¢ç´æ’­æ”¾å¤±è´¥: ' + e.message);
                                return null;
                            }),
                            audioPlayers.wave.play().catch(e => {
                                showDebug('æµ·æµªæ’­æ”¾å¤±è´¥: ' + e.message);
                                return null;
                            }),
                            audioPlayers.voice.play().catch(e => {
                                showDebug('è¯­éŸ³æ’­æ”¾å¤±è´¥: ' + e.message);
                                return null;
                            })
                        ];

                        await Promise.all(playPromises);
                        showDebug('âœ“ æ’­æ”¾å¼€å§‹');

                    } catch (e) {
                        showDebug('æ’­æ”¾é”™è¯¯: ' + e.message);
                    }
                }, 500);

                updateTrackInfo();

            } catch (e) {
                showDebug('åŠ è½½é”™è¯¯: ' + e.message);
                console.error(e);
            }
        }

        function updateTrackInfo() {
            const pianoNames = {
                anxiety: ['Documentary', 'Calm Waves', 'Emotional'],
                focus: ['Minimalistic', 'Scarborough', 'Variation'],
                sleep: ['Daylight', 'Soft Piano 1', 'Soft Piano 2'],
                nap: ['Cafe Jazz', 'Inspiring', 'Morning Zen']
            };

            const pianoName = pianoNames[current.scene][current.currentPianoIndex];
            const oceanName = {mediterranean: 'åœ°ä¸­æµ·', atlantic: 'å¤§è¥¿æ´‹', pacific: 'å¤ªå¹³æ´‹'}[current.ocean];

            document.getElementById('trackInfo').textContent = 
                `ğŸ¹ ${pianoName} | ğŸŒŠ ${oceanName} | ğŸ™ï¸ ${scenes[current.scene].name}`;
        }

        function togglePlay() {
            if (!current.isPlaying) {
                startPlaying();
                return;
            }

            if (current.isPaused) {
                resumeAll();
            } else {
                pauseAll();
            }
        }

        function resumeAll() {
            if (audioPlayers.piano) audioPlayers.piano.play().catch(e => console.log(e));
            if (audioPlayers.wave) audioPlayers.wave.play().catch(e => console.log(e));
            if (audioPlayers.voice) audioPlayers.voice.play().catch(e => console.log(e));
            current.isPaused = false;
            startTimer();
            updatePlayButtonUI();
        }

        function pauseAll() {
            if (audioPlayers.piano) audioPlayers.piano.pause();
            if (audioPlayers.wave) audioPlayers.wave.pause();
            if (audioPlayers.voice) audioPlayers.voice.pause();
            current.isPaused = true;
            clearInterval(current.timerInterval);
            updatePlayButtonUI();
        }

        function stopAll() {
            if (audioPlayers.piano) {
                audioPlayers.piano.pause();
                audioPlayers.piano.currentTime = 0;
            }
            if (audioPlayers.wave) {
                audioPlayers.wave.pause();
                audioPlayers.wave.currentTime = 0;
            }
            if (audioPlayers.voice) {
                audioPlayers.voice.pause();
                audioPlayers.voice.currentTime = 0;
            }

            current.isPlaying = false;
            current.isPaused = false;
            current.timeLeft = current.timer * 60;

            clearInterval(current.timerInterval);
            updateTimerDisplay();
            updatePlayButtonUI();
            document.getElementById('nowPlaying').style.display = 'none';
            showDebug('å·²åœæ­¢');
        }

        let isMuted = false;
        let previousVolumes = {};
        function toggleMute() {
            isMuted = !isMuted;
            const btn = document.getElementById('muteBtn');

            if (isMuted) {
                previousVolumes = {
                    piano: audioPlayers.piano ? audioPlayers.piano.volume : 0.6,
                    wave: audioPlayers.wave ? audioPlayers.wave.volume : 0.5,
                    voice: audioPlayers.voice ? audioPlayers.voice.volume : 0.8
                };
                if (audioPlayers.piano) audioPlayers.piano.volume = 0;
                if (audioPlayers.wave) audioPlayers.wave.volume = 0;
                if (audioPlayers.voice) audioPlayers.voice.volume = 0;
                btn.textContent = 'ğŸ”‡';
                document.getElementById('volPiano').value = 0;
                document.getElementById('volWave').value = 0;
                document.getElementById('volVoice').value = 0;
            } else {
                if (audioPlayers.piano) audioPlayers.piano.volume = previousVolumes.piano || 0.6;
                if (audioPlayers.wave) audioPlayers.wave.volume = previousVolumes.wave || 0.5;
                if (audioPlayers.voice) audioPlayers.voice.volume = previousVolumes.voice || 0.8;
                btn.textContent = 'ğŸ”Š';
                document.getElementById('volPiano').value = (previousVolumes.piano || 0.6) * 100;
                document.getElementById('volWave').value = (previousVolumes.wave || 0.5) * 100;
                document.getElementById('volVoice').value = (previousVolumes.voice || 0.8) * 100;
            }
        }

        function updateVolume(type, value) {
            const volume = value / 100;
            if (audioPlayers[type]) {
                audioPlayers[type].volume = volume;
            }
            if (isMuted && volume > 0) {
                isMuted = false;
                document.getElementById('muteBtn').textContent = 'ğŸ”Š';
            }
        }

        function startTimer() {
            clearInterval(current.timerInterval);
            current.timerInterval = setInterval(() => {
                if (current.timeLeft > 0) {
                    current.timeLeft--;
                    updateTimerDisplay();
                } else {
                    stopAll();
                    alert(translations[current.lang].startBtn + ' - Complete!');
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(current.timeLeft / 60);
            const seconds = current.timeLeft % 60;
            const display = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timerDisplay').textContent = display;
        }

        function updatePlayButtonUI() {
            const t = translations[current.lang];
            const mainBtn = document.getElementById('mainPlayBtn');
            const playPauseBtn = document.getElementById('playPauseBtn');

            if (!current.isPlaying) {
                mainBtn.innerHTML = `<span data-i18n="startBtn">${t.startBtn}</span>`;
                playPauseBtn.textContent = 'â–¶';
            } else if (current.isPaused) {
                mainBtn.innerHTML = `<span data-i18n="continueBtn">${t.continueBtn}</span>`;
                playPauseBtn.textContent = 'â–¶';
            } else {
                mainBtn.innerHTML = `<span data-i18n="pauseBtn">${t.pauseBtn}</span>`;
                playPauseBtn.textContent = 'â¸';
            }
        }

        function selectPlan(plan) {
            alert('Plan: ' + plan + '\nPlease contact admin to unlock');
            closePremium();
        }

        function closePremium() {
            document.getElementById('premiumModal').style.display = 'none';
        }

        window.onload = () => {
            initAudio();
            updateStatus();
            updateTimerDisplay();
            updatePrices('zh'); // é»˜è®¤ä¸­æ–‡ä»·æ ¼

            document.getElementById('premiumModal').addEventListener('click', function(e) {
                if (e.target === this) closePremium();
            });

            showDebug('é¡µé¢åŠ è½½å®Œæˆ');
        };

        window.onbeforeunload = () => {
            clearInterval(current.timerInterval);
            Object.values(audioPlayers).forEach(audio => {
                if (audio) {
                    audio.pause();
                    audio.src = '';
                }
            });
        };
    </script>
</body>
</html>