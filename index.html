<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é’¢ç´æµ· - Piano Sea</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #667eea 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }
        .container { max-width: 100%; padding: 20px; padding-bottom: 200px; }
        header { text-align: center; padding: 30px 0 15px; }
        h1 {
            font-size: 2.2em; margin-bottom: 5px;
            background: linear-gradient(to right, #fff, #e0e0e0);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .subtitle { font-size: 1em; opacity: 0.9; }

        /* æµ·åŸŸé€‰æ‹© */
        .ocean-selector {
            background: rgba(255,255,255,0.15); backdrop-filter: blur(10px);
            border-radius: 20px; padding: 20px; margin: 15px 0;
            border: 2px solid rgba(255,255,255,0.3);
        }
        .selector-title { font-size: 1em; margin-bottom: 15px; font-weight: 600; }
        .wave-options { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .wave-btn {
            background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3);
            color: white; padding: 15px 5px; border-radius: 15px; cursor: pointer;
            transition: all 0.3s; text-align: center; position: relative;
        }
        .wave-btn:hover { transform: translateY(-3px); background: rgba(255,255,255,0.2); }
        .wave-btn.active { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: white; transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);
        }
        .wave-icon { font-size: 2em; display: block; margin-bottom: 8px; }
        .wave-name { font-size: 0.9em; font-weight: 600; }
        .wave-desc { font-size: 0.7em; opacity: 0.9; margin-top: 4px; }

        /* æ—¶æ®µé€‰æ‹© */
        .timer-selector {
            background: rgba(0,0,0,0.2); border-radius: 20px;
            padding: 20px; margin: 15px 0;
        }
        .timer-title { font-size: 1em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .timer-options { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
        .time-btn {
            background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3);
            color: white; padding: 12px 20px; border-radius: 25px; cursor: pointer;
            transition: all 0.3s; font-size: 0.9em; position: relative;
            min-width: 80px; text-align: center;
        }
        .time-btn:hover { background: rgba(255,255,255,0.2); transform: translateY(-2px); }
        .time-btn.active { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: white; transform: scale(1.1);
        }
        .free-badge {
            position: absolute; top: -8px; right: -5px;
            background: #4ade80; color: #000; font-size: 0.6em;
            padding: 2px 6px; border-radius: 10px; font-weight: bold;
        }
        .premium-badge {
            position: absolute; top: -8px; right: -5px;
            background: #fbbf24; color: #000; font-size: 0.6em;
            padding: 2px 6px; border-radius: 10px; font-weight: bold;
        }
        .time-btn.locked {
            opacity: 0.6; cursor: not-allowed;
            background: rgba(100,100,100,0.3);
        }

        .lang-switcher {
            display: flex; justify-content: center; gap: 8px; margin: 15px 0; flex-wrap: wrap;
        }
        .lang-btn {
            background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3);
            color: white; padding: 8px 15px; border-radius: 20px; cursor: pointer;
            font-size: 0.85em; transition: all 0.3s;
        }
        .lang-btn.active { background: rgba(102, 126, 234, 0.6); border-color: white; }

        .scene-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 15px 0; }
        .scene-card {
            background: rgba(255,255,255,0.1); border-radius: 15px;
            padding: 20px 10px; border: 2px solid rgba(255,255,255,0.2);
            cursor: pointer; transition: all 0.3s; text-align: center;
        }
        .scene-card:hover { transform: translateY(-3px); background: rgba(255,255,255,0.15); }
        .scene-card.active { 
            background: rgba(102, 126, 234, 0.5); border-color: white;
            transform: scale(1.02); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .scene-icon { font-size: 2.5em; margin-bottom: 8px; }
        .scene-title { font-size: 1.1em; font-weight: 600; margin-bottom: 5px; }
        .scene-duration { font-size: 0.75em; opacity: 0.8; }

        .guide-section {
            background: rgba(0,0,0,0.2); border-radius: 20px;
            padding: 20px; margin: 15px 0; text-align: center;
        }
        .status-box {
            background: rgba(255,255,255,0.1); border-radius: 12px;
            padding: 15px; margin-bottom: 15px; font-size: 0.95em;
            border-left: 4px solid #667eea;
        }
        .play-btn-main {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none; color: white; padding: 15px 50px;
            border-radius: 30px; cursor: pointer; font-size: 1.2em;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);
            transition: all 0.3s; font-weight: 600;
        }
        .play-btn-main:hover { transform: translateY(-3px) scale(1.05); }

        .player-controls {
            background: rgba(0,0,0,0.5); backdrop-filter: blur(20px);
            position: fixed; bottom: 0; left: 0; right: 0;
            padding: 20px; border-top: 1px solid rgba(255,255,255,0.2);
            z-index: 1000;
        }
        .timer-big { font-size: 3em; text-align: center; margin-bottom: 15px; font-weight: 300; }
        .controls-row {
            display: flex; justify-content: center; align-items: center; gap: 20px;
            margin-bottom: 15px;
        }
        .btn-circle {
            width: 50px; height: 50px; border-radius: 50%;
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3);
            color: white; cursor: pointer; font-size: 1.2em;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.3s;
        }
        .btn-circle:hover { background: rgba(255,255,255,0.2); transform: scale(1.1); }
        .btn-play-big {
            width: 70px; height: 70px; border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none; color: white; font-size: 1.8em; cursor: pointer;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);
            display: flex; align-items: center; justify-content: center;
        }
        .volume-grid {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;
        }
        .vol-item { text-align: center; }
        .vol-label { font-size: 0.85em; margin-bottom: 5px; display: flex; align-items: center; justify-content: center; gap: 5px; }
        input[type="range"] {
            width: 100%; height: 6px; border-radius: 3px;
            background: rgba(255,255,255,0.2); outline: none; -webkit-appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%;
            background: white; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        #feedback-btn {
            position: fixed; bottom: 200px; right: 20px; width: 55px; height: 55px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: white; text-decoration: none; font-size: 24px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
            z-index: 9999; border: 2px solid rgba(255,255,255,0.3);
        }

        /* VIPå¼¹çª— - 3æ¡£ä»·æ ¼ */
        .premium-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 10000; justify-content: center; align-items: center;
            padding: 20px;
        }
        .premium-content {
            background: linear-gradient(135deg, #1e3c72 0%, #667eea 100%);
            padding: 30px; border-radius: 20px; max-width: 400px; width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 2px solid rgba(255,255,255,0.2);
        }
        .premium-title { 
            font-size: 1.6em; margin-bottom: 10px; text-align: center;
            background: linear-gradient(to right, #fbbf24, #f59e0b);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .premium-subtitle { 
            text-align: center; font-size: 0.9em; opacity: 0.9; margin-bottom: 20px;
        }
        .price-cards {
            display: flex; flex-direction: column; gap: 12px; margin: 20px 0;
        }
        .price-card {
            background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px; padding: 15px; cursor: pointer;
            transition: all 0.3s; position: relative;
        }
        .price-card:hover {
            background: rgba(255,255,255,0.2); transform: translateX(5px);
        }
        .price-card.recommended {
            border-color: #fbbf24; background: rgba(251, 191, 36, 0.1);
        }
        .price-card.permanent {
            border-color: #f59e0b; background: rgba(245, 158, 11, 0.15);
        }
        .price-label {
            font-size: 0.8em; opacity: 0.8; margin-bottom: 5px;
        }
        .price-amount {
            font-size: 1.8em; font-weight: bold; color: #fbbf24;
        }
        .price-original {
            text-decoration: line-through; opacity: 0.5; font-size: 0.9em;
            margin-left: 10px;
        }
        .price-tag {
            position: absolute; top: -10px; right: 10px;
            background: #ef4444; color: white; font-size: 0.7em;
            padding: 3px 8px; border-radius: 10px; font-weight: bold;
        }
        .price-features {
            font-size: 0.75em; margin-top: 8px; opacity: 0.9;
        }
        .premium-features-list {
            background: rgba(0,0,0,0.2); border-radius: 10px;
            padding: 15px; margin: 15px 0; font-size: 0.85em;
        }
        .premium-features-list li {
            margin: 8px 0; list-style: none; padding-left: 20px;
            position: relative;
        }
        .premium-features-list li::before {
            content: "âœ“"; position: absolute; left: 0; color: #4ade80;
        }
        .btn-close-modal {
            width: 100%; background: transparent; color: white;
            border: 1px solid rgba(255,255,255,0.3); padding: 12px;
            border-radius: 10px; cursor: pointer; margin-top: 15px;
            transition: all 0.3s;
        }
        .btn-close-modal:hover { background: rgba(255,255,255,0.1); }
    </style>
<base target="_blank">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¹ é’¢ç´æµ·</h1>
            <p class="subtitle">ä¸€é”®æ”¾æ¾ï¼Œä¸æµ·å…±ç”Ÿ</p>
        </header>

        <!-- æµ·åŸŸé€‰æ‹© - ä½¿ç”¨çœŸå®éŸ³é¢‘æ–‡ä»¶ -->
        <div class="ocean-selector">
            <div class="selector-title">ğŸŒŠ é€‰æ‹©çœŸå®æµ·åŸŸå½•éŸ³ï¼ˆ3ç§ä¸åŒæµ·æµªå£°ï¼‰</div>
            <div class="wave-options">
                <button class="wave-btn active" onclick="selectOcean('mediterranean')">
                    <span class="wave-icon">ğŸŒ…</span>
                    <span class="wave-name">åœ°ä¸­æµ·</span>
                    <div class="wave-desc">è½»æŸ”ç»µé•¿</div>
                </button>
                <button class="wave-btn" onclick="selectOcean('atlantic')">
                    <span class="wave-icon">ğŸŒŠ</span>
                    <span class="wave-name">å¤§è¥¿æ´‹</span>
                    <div class="wave-desc">è§„å¾‹èˆ’ç¼“</div>
                </button>
                <button class="wave-btn" onclick="selectOcean('pacific')">
                    <span class="wave-icon">ğŸï¸</span>
                    <span class="wave-name">å¤ªå¹³æ´‹</span>
                    <div class="wave-desc">è‡ªç„¶æ²»æ„ˆ</div>
                </button>
            </div>
        </div>

        <!-- æ—¶æ®µé€‰æ‹© -->
        <div class="timer-selector">
            <div class="timer-title">â±ï¸ é€‰æ‹©æ”¾æ¾æ—¶é•¿</div>
            <div class="timer-options">
                <button class="time-btn active" onclick="selectTimer(15, false)">
                    15åˆ†é’Ÿ
                    <span class="free-badge">å…è´¹</span>
                </button>
                <button class="time-btn locked" onclick="selectTimer(30, true)">
                    30åˆ†é’Ÿ
                    <span class="premium-badge">VIP</span>
                </button>
                <button class="time-btn locked" onclick="selectTimer(60, true)">
                    60åˆ†é’Ÿ
                    <span class="premium-badge">VIP</span>
                </button>
            </div>
        </div>

        <!-- è¯­è¨€åˆ‡æ¢ -->
        <div class="lang-switcher">
            <button class="lang-btn active" onclick="changeLang('zh')">ğŸ‡¨ğŸ‡³ æ™®é€šè¯</button>
            <button class="lang-btn" onclick="changeLang('hk')">ğŸ‡­ğŸ‡° ç²¤è¯­</button>
            <button class="lang-btn" onclick="changeLang('en')">ğŸ‡¬ğŸ‡§ English</button>
            <button class="lang-btn" onclick="changeLang('es')">ğŸ‡ªğŸ‡¸ EspaÃ±ol</button>
            <button class="lang-btn" onclick="changeLang('ar')">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
        </div>

        <!-- åœºæ™¯é€‰æ‹© -->
        <div class="scene-grid">
            <div class="scene-card active" onclick="selectScene('anxiety')">
                <div class="scene-icon">ğŸ§˜</div>
                <div class="scene-title">ç„¦è™‘æ€¥æ•‘</div>
                <div class="scene-duration">2-3åˆ†é’Ÿè¯­éŸ³</div>
            </div>
            <div class="scene-card" onclick="selectScene('focus')">
                <div class="scene-icon">ğŸ¯</div>
                <div class="scene-title">é™å¿ƒä¸“æ³¨</div>
                <div class="scene-duration">1åˆ†é’Ÿè¯­éŸ³</div>
            </div>
            <div class="scene-card" onclick="selectScene('sleep')">
                <div class="scene-icon">ğŸŒ™</div>
                <div class="scene-title">ç¡å‰åŠ©çœ </div>
                <div class="scene-duration">3-5åˆ†é’Ÿè¯­éŸ³</div>
            </div>
            <div class="scene-card" onclick="selectScene('nap')">
                <div class="scene-icon">ğŸ˜´</div>
                <div class="scene-title">åˆä¼‘å°æ†©</div>
                <div class="scene-duration">3åˆ†é’Ÿè¯­éŸ³</div>
            </div>
        </div>

        <!-- æ’­æ”¾æ§åˆ¶ -->
        <div class="guide-section">
            <div class="status-box" id="statusBox">
                <div>å½“å‰ï¼šåœ°ä¸­æµ·çœŸå®å½•éŸ³ + ç„¦è™‘æ€¥æ•‘ + æ™®é€šè¯ + 15åˆ†é’Ÿï¼ˆå…è´¹ï¼‰</div>
                <div style="font-size: 0.8em; margin-top: 8px; opacity: 0.8;">
                    ä½¿ç”¨çœŸå®æµ·æµªéŸ³é¢‘æ–‡ä»¶ï¼šwave1.mp3
                </div>
            </div>
            <button class="play-btn-main" id="mainPlayBtn" onclick="startPlaying()">
                â–¶ï¸ å¼€å§‹æ”¾æ¾
            </button>
        </div>
    </div>

    <!-- åº•éƒ¨æ’­æ”¾å™¨ -->
    <div class="player-controls">
        <div class="timer-big" id="timerDisplay">15:00</div>
        <div class="controls-row">
            <button class="btn-circle" onclick="stopAll()" title="åœæ­¢">â¹</button>
            <button class="btn-play-big" id="playPauseBtn" onclick="togglePlay()">â–¶</button>
            <button class="btn-circle" onclick="toggleMute()" title="é™éŸ³">ğŸ”Š</button>
        </div>
        <div class="volume-grid">
            <div class="vol-item">
                <div class="vol-label">ğŸ¹ é’¢ç´</div>
                <input type="range" id="volPiano" min="0" max="100" value="60" onchange="updateVolumes()">
            </div>
            <div class="vol-item">
                <div class="vol-label">ğŸŒŠ æµ·æµª</div>
                <input type="range" id="volWave" min="0" max="100" value="50" onchange="updateVolumes()">
            </div>
            <div class="vol-item">
                <div class="vol-label">ğŸ™ï¸ è¯­éŸ³</div>
                <input type="range" id="volVoice" min="0" max="100" value="80" onchange="updateVolumes()">
            </div>
        </div>
    </div>

    <a href="https://forms.gle/r6znYF8Pr5ffVmAv9" target="_blank" id="feedback-btn">ğŸ’¬</a>

    <!-- VIPå¼¹çª— - 3æ¡£ä»·æ ¼ -->
    <div class="premium-modal" id="premiumModal">
        <div class="premium-content">
            <div class="premium-title">ğŸ”“ å‡çº§VIPä¼šå‘˜</div>
            <div class="premium-subtitle">è§£é”å®Œæ•´æ”¾æ¾ä½“éªŒï¼Œäº«å—æ›´å¤šä¸“å±æƒç›Š</div>

            <div class="price-cards">
                <div class="price-card" onclick="selectPlan('month')">
                    <div class="price-label">æœˆåº¦ä¼šå‘˜</div>
                    <div>
                        <span class="price-amount">Â¥18</span>
                        <span style="font-size: 0.9em;">/æœˆ</span>
                    </div>
                    <div class="price-features">é€‚åˆçŸ­æœŸä½“éªŒï¼Œéšæ—¶å¯å–æ¶ˆ</div>
                </div>

                <div class="price-card recommended" onclick="selectPlan('year')">
                    <span class="price-tag">æ¨è</span>
                    <div class="price-label">å¹´åº¦ä¼šå‘˜</div>
                    <div>
                        <span class="price-amount">Â¥238</span>
                        <span style="font-size: 0.9em;">/å¹´</span>
                        <span class="price-original">Â¥216</span>
                    </div>
                    <div class="price-features">ç«‹çœ178å…ƒï¼Œå¹³å‡æ¯å¤©ä»…éœ€0.65å…ƒ</div>
                </div>

                <div class="price-card permanent" onclick="selectPlan('permanent')">
                    <span class="price-tag">è¶…å€¼</span>
                    <div class="price-label">æ°¸ä¹…ä¼šå‘˜</div>
                    <div>
                        <span class="price-amount">Â¥498</span>
                        <span style="font-size: 0.9em;">æ°¸ä¹…æœ‰æ•ˆ</span>
                    </div>
                    <div class="price-features">ä¸€æ¬¡ä»˜è´¹ï¼Œç»ˆèº«äº«ç”¨ï¼Œæ— é™æ›´æ–°</div>
                </div>
            </div>

            <ul class="premium-features-list">
                <li>æ— é™æ—¶é•¿ï¼š30åˆ†é’Ÿã€60åˆ†é’Ÿæ·±åº¦æ”¾æ¾æ¨¡å¼</li>
                <li>å…¨éƒ¨5ç§è¯­è¨€å®Œæ•´ç‰ˆè¯­éŸ³å¼•å¯¼</li>
                <li>3ç§çœŸå®æµ·åŸŸæµ·æµªå£°ä»»æ„åˆ‡æ¢</li>
                <li>ç¦»çº¿ä¸‹è½½åŠŸèƒ½ï¼Œæ— ç½‘ç»œä¹Ÿèƒ½ä½¿ç”¨</li>
                <li>ä¼˜å…ˆä½“éªŒæ–°åœºæ™¯ã€æ–°åŠŸèƒ½</li>
                <li>æ— å¹¿å‘Šçº¯å‡€ä½“éªŒ</li>
            </ul>

            <button class="btn-close-modal" onclick="closePremium()">ğŸ‘‹ æš‚æ—¶ç»§ç»­å…è´¹ä½“éªŒ</button>
        </div>
    </div>

    <script>
        // é…ç½® - 3ç§çœŸå®æµ·æµªéŸ³é¢‘æ–‡ä»¶
        const oceanConfig = {
            mediterranean: { 
                name: 'åœ°ä¸­æµ·', 
                file: 'audio/wave1.mp3',  // æ‚¨çš„çœŸå®å½•éŸ³1
                volume: 0.5
            },
            atlantic: { 
                name: 'å¤§è¥¿æ´‹', 
                file: 'audio/wave2.mp3',  // æ‚¨çš„çœŸå®å½•éŸ³2
                volume: 0.5
            },
            pacific: { 
                name: 'å¤ªå¹³æ´‹', 
                file: 'audio/wave3.mp3',  // æ‚¨çš„çœŸå®å½•éŸ³3
                volume: 0.5
            }
        };

        const scenes = {
            anxiety: { name: 'ç„¦è™‘æ€¥æ•‘', piano: 'calm' },
            focus: { name: 'é™å¿ƒä¸“æ³¨', piano: 'focus' },
            sleep: { name: 'ç¡å‰åŠ©çœ ', piano: 'sleep' },
            nap: { name: 'åˆä¼‘å°æ†©', piano: 'nap' }
        };

        const langNames = { 
            'zh': 'æ™®é€šè¯', 'hk': 'ç²¤è¯­', 'en': 'è‹±è¯­', 
            'es': 'è¥¿ç­ç‰™è¯­', 'ar': 'é˜¿æ‹‰ä¼¯è¯­' 
        };

        const pianoTracks = {
            calm: 'https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3',
            focus: 'https://cdn.pixabay.com/download/audio/2022/03/15/audio_c8c8a73467.mp3',
            sleep: 'https://cdn.pixabay.com/download/audio/2021/11/25/audio_66b06d3e32.mp3',
            nap: 'https://cdn.pixabay.com/download/audio/2022/01/18/audio_d0a13f69d2.mp3'
        };

        // çŠ¶æ€
        let current = {
            scene: 'anxiety',
            lang: 'zh',
            ocean: 'mediterranean',
            timer: 15,
            isPremium: false,
            isPlaying: false,
            timeLeft: 15 * 60
        };

        // éŸ³é¢‘å¯¹è±¡
        let audio = {
            wave: new Audio(),
            voice: new Audio(),
            piano: new Audio()
        };

        audio.wave.loop = true;
        audio.piano.loop = true;

        // åˆå§‹åŒ–åŠ è½½ç¬¬ä¸€ä¸ªæµ·æµª
        audio.wave.src = oceanConfig.mediterranean.file;

        // é€‰æ‹©æµ·åŸŸ - åˆ‡æ¢çœŸå®éŸ³é¢‘æ–‡ä»¶
        function selectOcean(ocean) {
            current.ocean = ocean;
            document.querySelectorAll('.wave-btn').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');

            const config = oceanConfig[ocean];

            // å¦‚æœæ­£åœ¨æ’­æ”¾ï¼Œå…ˆæ·¡å‡ºå†åˆ‡æ¢
            if (current.isPlaying) {
                const oldVolume = audio.wave.volume;
                audio.wave.volume = 0;

                setTimeout(() => {
                    audio.wave.src = config.file;
                    audio.wave.volume = config.volume * (document.getElementById('volWave').value / 100);
                    audio.wave.play().catch(e => console.log('åˆ‡æ¢æµ·æµªå¤±è´¥:', e));
                }, 300);
            } else {
                audio.wave.src = config.file;
                audio.wave.volume = config.volume * (document.getElementById('volWave').value / 100);
            }

            updateStatusDisplay();
        }

        // é€‰æ‹©æ—¶æ®µ
        function selectTimer(minutes, isPremium) {
            if (isPremium && !current.isPremium) {
                document.getElementById('premiumModal').style.display = 'flex';
                return;
            }

            current.timer = minutes;
            current.timeLeft = minutes * 60;

            document.querySelectorAll('.time-btn').forEach(btn => {
                btn.classList.remove('active');
                if (!btn.classList.contains('locked')) {
                    btn.style.opacity = '1';
                }
            });
            event.currentTarget.classList.add('active');

            updateTimerDisplay();
            updateStatusDisplay();
        }

        // é€‰æ‹©å¥—é¤ï¼ˆæ¨¡æ‹Ÿï¼‰
        function selectPlan(plan) {
            const prices = {
                'month': '18å…ƒ/æœˆ',
                'year': '238å…ƒ/å¹´',
                'permanent': '498å…ƒæ°¸ä¹…'
            };
            alert(`æ‚¨é€‰æ‹©äº†ï¼š${prices[plan]}\n\nè¯·è”ç³»ç®¡ç†å‘˜å¼€é€šVIPä¼šå‘˜\nå¾®ä¿¡å·ï¼šLaoban\næˆ–å‘é€é‚®ä»¶è‡³ï¼šsupport@pianosea.com`);
        }

        // å…³é—­å¼¹çª—
        function closePremium() {
            document.getElementById('premiumModal').style.display = 'none';
        }

        // é€‰æ‹©åœºæ™¯
        function selectScene(scene) {
            current.scene = scene;
            document.querySelectorAll('.scene-card').forEach(card => card.classList.remove('active'));
            event.currentTarget.classList.add('active');
            updateStatusDisplay();
        }

        // è¯­è¨€åˆ‡æ¢
        function changeLang(lang) {
            current.lang = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            updateStatusDisplay();
        }

        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatusDisplay() {
            const ocean = oceanConfig[current.ocean];
            const timerType = current.timer === 15 ? 'å…è´¹' : 'VIP';
            const waveFile = ocean.file.replace('audio/', '');

            document.getElementById('statusBox').innerHTML = `
                <div>å½“å‰ï¼š${ocean.name}çœŸå®å½•éŸ³ + ${scenes[current.scene].name} + ${langNames[current.lang]} + ${current.timer}åˆ†é’Ÿï¼ˆ${timerType}ï¼‰</div>
                <div style="font-size: 0.8em; margin-top: 8px; opacity: 0.8;">
                    æµ·æµªéŸ³é¢‘æ–‡ä»¶ï¼š${waveFile}
                </div>
            `;
        }

        // æ›´æ–°è®¡æ—¶å™¨
        function updateTimerDisplay() {
            const m = Math.floor(current.timeLeft / 60);
            const s = current.timeLeft % 60;
            document.getElementById('timerDisplay').textContent = 
                String(m).padStart(2, '0') + ':' + String(s).padStart(2, '0');
        }

        // å¼€å§‹æ’­æ”¾
        async function startPlaying() {
            if (current.isPlaying) {
                pauseAll();
                return;
            }

            // åŠ è½½éŸ³é¢‘
            const voicePath = `audio/${scenes[current.scene].name}-${langNames[current.lang]}.mp3`;
            audio.voice.src = voicePath;
            audio.piano.src = pianoTracks[scenes[current.scene].piano];

            // è®¾ç½®éŸ³é‡
            const ocean = oceanConfig[current.ocean];
            audio.wave.volume = ocean.volume * (document.getElementById('volWave').value / 100);
            audio.piano.volume = document.getElementById('volPiano').value / 100;
            audio.voice.volume = document.getElementById('volVoice').value / 100;

            try {
                await Promise.all([
                    audio.wave.play(),
                    audio.voice.play(),
                    audio.piano.play()
                ]);

                current.isPlaying = true;
                document.getElementById('mainPlayBtn').innerHTML = 'â¸ï¸ æš‚åœ';
                document.getElementById('playPauseBtn').textContent = 'â¸';

                startTimer();

                audio.voice.onended = () => {
                    document.getElementById('statusBox').innerHTML += 
                        '<div style="margin-top: 5px; color: #a8e6cf;">ğŸµ è¯­éŸ³å¼•å¯¼ç»“æŸï¼Œç»§ç»­æ’­æ”¾èƒŒæ™¯éŸ³ä¹...</div>';
                };

            } catch (err) {
                alert('éŸ³é¢‘æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨');
                console.error(err);
            }
        }

        // è®¡æ—¶å™¨
        let timerInterval;
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                if (current.timeLeft > 0) {
                    current.timeLeft--;
                    updateTimerDisplay();
                } else {
                    stopAll();
                    alert('æ”¾æ¾æ—¶é—´ç»“æŸï¼Œç¥æ‚¨æœ‰ç¾å¥½çš„ä¸€å¤©ï¼');
                }
            }, 1000);
        }

        // æ§åˆ¶å‡½æ•°
        function togglePlay() {
            if (current.isPlaying) {
                pauseAll();
            } else {
                startPlaying();
            }
        }

        function pauseAll() {
            audio.wave.pause();
            audio.voice.pause();
            audio.piano.pause();
            clearInterval(timerInterval);
            current.isPlaying = false;
            document.getElementById('mainPlayBtn').innerHTML = 'â–¶ï¸ ç»§ç»­';
            document.getElementById('playPauseBtn').textContent = 'â–¶';
        }

        function stopAll() {
            pauseAll();
            current.timeLeft = current.timer * 60;
            updateTimerDisplay();
            audio.wave.currentTime = 0;
            audio.voice.currentTime = 0;
            audio.piano.currentTime = 0;
            document.getElementById('mainPlayBtn').innerHTML = 'â–¶ï¸ å¼€å§‹æ”¾æ¾';
        }

        let isMuted = false;
        function toggleMute() {
            isMuted = !isMuted;
            audio.wave.muted = isMuted;
            audio.voice.muted = isMuted;
            audio.piano.muted = isMuted;
            event.target.textContent = isMuted ? 'ğŸ”‡' : 'ğŸ”Š';
        }

        function updateVolumes() {
            if (!current.isPlaying) return;
            const ocean = oceanConfig[current.ocean];
            audio.wave.volume = ocean.volume * (document.getElementById('volWave').value / 100);
            audio.piano.volume = document.getElementById('volPiano').value / 100;
            audio.voice.volume = document.getElementById('volVoice').value / 100;
        }

        // åˆå§‹åŒ–
        window.onload = () => {
            updateTimerDisplay();
            updateStatusDisplay();
        };
    </script>
</body>
</html>